# 速成版：
本部分资料来源：b站数之道系列视频
我们都知道，图片是由像素点构成的，而其最终的成像效果是由像素的颜色及数值所决定的。
下面这个6 * 6 的 excel 表格，由0，1两个数字构成，而如果我们把0看成黑色，把1看成白色，肉眼观察很像数字‘7’。而通过CNN（Convolutional Neural Networks)模型能告诉我们，这样一个6 * 6 的像素图是不是数字7，或者返回它属于数字0~9的概率分别是多少。
CNN模型：
==Step1 ：提取图片特征==
使用卷积核（也可以称作特征过滤器，即下图 3 * 3的像素图 ）提取图片特征。两个卷积核分别提取垂直特征和水平特征。
提取特征的计算规则：
按照顺序提取原始图片中3 * 3的像素区域，再将其每个像素单元依次和卷积核内对应的像素单元相乘再求和，然后把结果记录在4 * 4的特征图上。
在特征图中，我们根据像素值的大小设置颜色的深浅。
观察可得，原始图片的垂直特征被很好地提取出来，而水平特征却没有被提取出来。
这是因为在特征提取计算过程中，像素图被降维（从6 * 6 到4 * 4），**边缘的特征消失**了。
![image.png](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410061820820.png)

因此为了解决边缘特征的提取问题，我们使用Padding，这是一种扩充方法。将原始的6 * 6图像先扩充成8 * 8，扩充部分的像素值均被设置为0。
这样在进行特征提取计算之后，转化后的特征图的像素仍为6 * 6，如此一来，水平和垂直的特征都得到了完美的提取。
![image.png](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410061819193.png)

==Step2：最大池化 Max Pooling==
goal：将图片的数据更进步一步地压缩，仅反映出特征图中“最突出”的特点。
将6 * 6的特征图用2 * 2的网格分割成3 * 3的部分，然后提取每个部分的最大值，并放入最大池化后的3 * 3网格中。池化后的数据保留了原始图片中最精华的部分。

![230616f3814c04511d7d4b96837b01a.jpg](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410061817505.jpg)
![image.png](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410061818462.png)

Step3：扁平化处理
把池化后的特征图进行扁平化处理，把两个3 * 3的像素图叠加，转化成一维的“数据条”，数据条录入到后面的全连接隐藏层，最终产生输出结果。
![image.png](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410061823476.png)

扁平化之后的流程与ANN模型是完全一样的。
全连接隐藏层意味着任意一个神经元都与前后层的所有神经元相连接，确保最终的输出值是基于图片整体信息的结果。
而在最后的输出阶段，我们可以使用Sigmoid函数返回0~1的值代表该图片是7的概率。也可以使用SoftMax函数返回它分别属于0~9的概率。
现在，一个完整的CNN模型数据流就此完成。

# 完整版（补充ing）

### 卷积核（特征过滤器）
可以检测出垂直边缘的常用卷积核有：

![image.png](https://erin-53347-1330131220.cos.ap-guangzhou.myqcloud.com/202410101630574.png)
除了这些可以单纯检测出垂直抑或水平边缘的卷积核，还有其它能够检测出任意角度的边缘的卷积核。